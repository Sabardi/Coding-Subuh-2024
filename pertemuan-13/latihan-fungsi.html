<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>latihan Fungsi</title>
    <style>
        *{
            box-sizing: 0;
            margin: 0;
            padding: 0;
            font-family: sans-serif;
        }

        .app{
            max-width: 600px;
            margin: 0 auto;
            padding: 0 auto;
        }
        .navbar{
            display: flex;
            width: 100%;
            justify-content: space-between;
            align-items: center;
            padding: 0.5em;
            background-color: lightblue;
        }

        .profile{
            display: inline-flex;
            align-items: center;
            gap: 1em;

        }

        .profile img{
            border-radius: 50%;
            width: 2em;
            height: 2em;

        }

        .tweetCompose textarea{
            width: 100%;
            padding: 0.5em;
        }
    </style>
</head>
<body>
    
    <div class="app">

        <nav class="navbar">
            <a href="#">App Logo</a>
            <div class="profile">
                <span id="userName">User Name</span>
                <img src="https://ui-avatars.com/api/?background=random" alt="" id="userAvatar">
            </div>
        </nav>

        <!-- elemet input -->
        <div class="tweetCompose">
            <textarea name="" id="inputTweetMessage" cols="10" rows="30" placeholder="Whats happen"
            onkeyup="calculatCharCount(this)"></textarea>
            <button onclick="postTweet()" id="btnPost">Post</button>
            <span id="charCountRemaining"></span>
        </div>

        <!-- element output -->
        <h1>Feeds</h1>
        <div id="feed" class="feed"></div>
    </div>

    <script>
         // akan berisi objek dari tweet masege
        var post = [];
        
        // objek user yang sedang login
        var user = {
            name: "SABARDI",
            username: "@Bardi",
            getAvatar: function(){
                return `https://ui-avatars.com/api/?background=random&name= ${this.name}`;
            }
        }

        // menampilkan user 
        function showUserProfile(){
            // menampilkan user ke navbar 
            document.getElementById("userName").textContent = user.name;
            document.getElementById("userAvatar").src = user.getAvatar();
        }

        // membuat fungsi kalkulasi karacter nya
        function calculatCharCount(textarea){
            const MAX_CHAR_ALLOWED = 140;
            const charRemaining = document.getElementById("charCountRemaining");
            const remining = MAX_CHAR_ALLOWED - textarea.value.length;

            charRemaining.textContent = remining;

            // melakukan pengecekan jika dia lebih dari 140 kata 
            if(remining < 10){
                charRemaining.style.color = "tomato";
            }else if(remining < 30){
                charRemaining.style.color = "orange";
            }else{
                charRemaining.style.color = "black";
            }
            
            const disabled = remining < 0 ? true : false;
            document.getElementById("btnPost").disabled = disabled;

        }

            
        // membuat fungsi untuk posting
        function postTweet(){
            // mengambil iputan 
            const pesanInput = document.getElementById("inputTweetMessage").value;

            // melakukan pengecekan apaka yg di inputkan kosong / tidak 
            if(pesanInput.length <= 0 && pesanInput === ""){
                alert("pesan tidak boleh kosong")
                return
            }

            // membuat objek menyimpan tweet
            const tweet = {
                pesan: pesanInput,
                author: {...user },
                date: new Date()
            };

            // tambahkan objek ke dalam array posts
            post.unshift(tweet)

            // menampilkan tweet / postingan nya
            showTweet();
        }

        // fungsi untuk menampilkan postingan        
        function showTweet(){
            post.forEach(tweet => {
                // menampilkan data nya
                const tweetaTemplate = `
                <div class="tweet">
                    <header>
                        <img src="${tweet.author.getAvatar()}" alt="">
                        ${tweet.author.name}
                        (${tweet.author.username})
                        &middot;
                        ${tweet.date}
                        <p class="message">
                            ${tweet.pesan}
                        </p>
                    </header>
                </div>
                `;
            document.getElementById("feed").innerHTML += tweetaTemplate;

            });
        }

        // event setelah dokument html di load
        document.addEventListener("DOMContentLoaded", function(){
            // panggil fugsi show user 
            showUserProfile();
        })
    </script>
</body>
</html>